<!DOCTYPE html>
<html>

<head>
    <title>Websocket JS client</title>
</head>

<body>
    <h1>JS Websocket test</h1>
    <script type="text/javascript" src="signalr.min.js"></script>

    <script type="text/javascript">

        var connection = new signalR.HubConnectionBuilder()
            .withUrl('http://127.0.0.1:5000/ws')
            .build();

        connection.on("direct", data => {
            var response = JSON.parse(data);
            if (response.ResponseType === 'gamestatus') {
                console.log('game status update tick');
            }
            else {
                console.log(response.Payload);
            }
        });

        connection.start()
            .then(() => connection.invoke("SendAsync", '{ RequestName: "Authenticate", Payload: "arch;1234" }'))
            .then(() => connection.invoke("SendAsync", '{ RequestName: "lobby.newgame" }'));

    </script>
</body>

</html>